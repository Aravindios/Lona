// Generated by BUCKLESCRIPT VERSION 2.1.0, PLEASE EDIT WITH CARE
'use strict';

var Fs                      = require("fs");
var List                    = require("bs-platform/lib/js/list.js");
var Json_decode             = require("bs-json/src/Json_decode.js");
var Caml_builtin_exceptions = require("bs-platform/lib/js/caml_builtin_exceptions.js");

function parseFile(filename) {
  var content = Fs.readFileSync(filename, "utf8");
  var parsed = JSON.parse(content);
  var parseColor = function (json) {
    return /* record */[
            /* id */Json_decode.field("id", Json_decode.string, json),
            /* name */Json_decode.field("name", Json_decode.string, json),
            /* value */Json_decode.field("value", Json_decode.string, json)
          ];
  };
  return Json_decode.field("colors", (function (param) {
                return Json_decode.list(parseColor, param);
              }), parsed);
}

function find(colors, id) {
  var exit = 0;
  var color;
  try {
    color = List.find((function (color) {
            return +(color[/* id */0] === id);
          }), colors);
    exit = 1;
  }
  catch (exn){
    if (exn === Caml_builtin_exceptions.not_found) {
      return /* None */0;
    } else {
      throw exn;
    }
  }
  if (exit === 1) {
    return /* Some */[color];
  }
  
}

exports.parseFile = parseFile;
exports.find      = find;
/* fs Not a pure module */
